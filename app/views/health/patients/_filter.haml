- if @active_filter
  - filter_class = 'client__filter-active'
- else
  - filter_class = 'client__filter'

.dropdown.o-filtration{class: filter_class}
  %button.btn.btn-secondary.dropdown-toggle{data: {toggle: 'dropdown'}}
    Filter
    %span.caret

  .o-filtration__container.dropdown-menu.dropdown-menu-left.options
    .o-filtration__header
      %h3.client__filter-header Status

    = form_tag(nil, method: "get") do
      -# preserve search for filtering
      - if params[:q] && params[:q][:full_text_search]
        = hidden_field_tag 'q[full_text_search]', params[:q][:full_text_search]
      .btn-group{data: {toggle: :buttons}}
        - active = params[:filter].blank? || params[:filter][:population] == 'all'
        %label.btn.btn-secondary{class: "#{active ? :active : ''}"}
          %input{type: :radio, name: 'filter[population]', value: :all, autocomplete: :off, checked: active} All
        - active = params[:filter].present? && params[:filter][:population] == 'not_engaged'
        %label.btn.btn-secondary{class: "#{active ? :active : ''}"}
          %input{type: :radio, name: 'filter[population]', value: :not_engaged, autocomplete: :off, checked: active} Not yet engaged
        - active = params[:filter].present? && params[:filter][:population] == 'no_activities'
        %label.btn.btn-secondary{class: "#{active ? :active : ''}"}
          %input{type: :radio, name: 'filter[population]', value: :no_activities, autocomplete: :off, checked: active} 0 Qualified activities this month

      .o-filtration__actions.form__actions
        = link_to health_patients_path, class:'btn btn-secondary' do
          %span.icon-cross.icon-inline
          Clear Filters
        %button.btn.btn-primary.ml-auto{type: :submit}
          %span.icon-filter.icon-inline.mr-1
          Filter



= content_for :page_js do
  :javascript
    $('.dropdown-toggle').click(function(event){
      $(event.currentTarget).blur()
    })
