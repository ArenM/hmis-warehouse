- id = organization.id
%tr.jOrganization{data: {organization_id: id}}
  %td.jToggle.closed
    ▶︎
  %td{style: 'width: 4em;'}
    %em{class: "ds-#{data_source.downcase}"}
      = data_source
  %td{style: 'width: 16em;'}
    = organization.OrganizationName
  %td{colspan: 4}
    = check_box_tag("organization-toggle[#{id}]", 1, false, {class: 'jSelectAll', data: {organization_id: id}})
%tr.jProject.hidden{data: {organization_id: id}}
  %th
  %th
    Type
  %th
    Project
  %th
    Select
  %th
    Report
  %th
    Contact(s)
  %th
    Last Sent On
- projects.each do |project|
  - last_report = project.data_qualilty_reports&.last
  %tr.jProject.hidden{data: {organization_id: id}}
    %td
    %td
      = HUD.project_type_brief(project.ProjectType)
    %td.padding-left-02
      = project.ProjectName
    %td
      = check_box_tag("project[#{project.id}]", 1, false, {class: 'jProjectSelect'})
    %td
      - if last_status = last_report&.status
        = link_to last_status, project_data_quality_report_path(project_id: project.id, id: last_report.id) 
      -else 
        = content_tag( :em, 'not available')
    %td
      - if project.project_contacts.any?
        = project.project_contacts.map{|m| "#{m.first_name} #{m.last_name} (#{m.email})"}.join(', ')
      - else
        = link_to project_project_contacts_path(project) do
          Add project contacts
        on the
        = link_to project_path(project) do
          project page
    %td
      = last_report&.sent_at&.to_date