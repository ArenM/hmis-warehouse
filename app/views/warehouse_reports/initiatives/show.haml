- vm = WarehouseReport::InitiativeBarCharts.new(@data, @report_range, @comparison_range)
- title = "#{@parameters.initiative_name} Initiative Report"
- content_for :title, title

%h1= content_for :title
= render 'token_access'
= render 'parameters', report: @parameters

.warehouse-reports__initiatives
  -# Outcomes
  = render 'outcomes'
  - show_view_partials.each do |p|
    - if p[:partial] == 'breakdown'
      %h2
        %span= p[:title] || p[:data].to_s.humanize.titleize
      - [:project_type, :project].each do |by|
        - title = p[:title].present? ? "#{p[:title]} by #{by.to_s.titleize}" : "#{p[:data].to_s.titleize} by #{by.to_s.titleize}"
        = render p[:partial], title: title, vm: vm, data_type: p[:data], by: by, chart_1: :report, chart_2: :comparison
    - elsif p[:partial] == 'income_pie_charts'
      %h2
        %span= p[:title] || p[:data].to_s.humanize.titleize
      = render p[:partial], data_type: p[:data]
    - else
      %h2
        %span= p[:title]
      = render p[:partial], title: p[:title]

- content_for :page_js do
  :javascript
    $(document).ready(function() {
      $('.loso-collapse').on('shown.bs.collapse', function(event) {
        var id = event.target.id
        $('[data-target="#'+id+'"]').text('Hide Details')
      })
      $('.loso-collapse').on('hidden.bs.collapse', function(event) {
        var id = event.target.id
        $('[data-target="#'+id+'"]').text('Show Details')
      })
    })
