# Initial Setup - Done Once

  Install the AWS CLI
  https://docs.aws.amazon.com/cli/latest/userguide/install-cliv2-linux-mac.html

  Configure the AWS CLI
  aws2 --profile=openpath configure

  Install the ECS CLI
  https://docs.aws.amazon.com/AmazonECS/latest/developerguide/ECS_CLI_installation.html
  ```
  sudo curl -o /usr/local/bin/ecs-cli https://amazon-ecs-cli.s3.amazonaws.com/ecs-cli-darwin-amd64-latest
  curl -s https://amazon-ecs-cli.s3.amazonaws.com/ecs-cli-darwin-amd64-latest.md5 &&md5 -q /usr/local/bin/ecs-cli
  sudo chmod +x /usr/local/bin/ecs-cli
  ecs-cli configure profile --profile-name openpath --access-key $AWS_ACCESS_KEY_ID --secret-key $AWS_SECRET_ACCESS_KEY
  ```


  ECS Reference
  https://docs.aws.amazon.com/cli/latest/reference/ecs/index.html

  Install JQ
  ```
  brew install jq
  ```

  Creating a Cluster
  https://docs.aws.amazon.com/AmazonECS/latest/developerguide/ecs-cli-tutorial-ec2.html
  ```
  ecs-cli configure --cluster open-path-warehouse --default-launch-type EC2 --config-name open-path-warehouse --region us-east-1
  ecs-cli configure profile --access-key $AWS_ACCESS_KEY_ID --secret-key $AWS_SECRET_ACCESS_KEY --profile-name open-path-warehouse-profile
  ecs-cli up --keypair aws_ssh --capability-iam --size 2 --instance-type t3.small --cluster-config open-path-warehouse --ecs-profile open-path-warehouse-profile --security-group staging_server_rules --vpc vpc-fe705f9a --subnets subnet-d6c2bcb3,subnet-a2640e9f
  ```

  Removing the cluster above (Don't do this in production!)
  ```
  ecs-cli down --cluster-config open-path-warehouse --ecs-profile open-path-warehouse-profile
  ```

  Deploy to the Cluster
  ecs-cli compose up --create-log-groups --cluster-config open-path-warehouse --ecs-profile open-path-warehouse-profile